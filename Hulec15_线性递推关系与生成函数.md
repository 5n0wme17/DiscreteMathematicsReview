  # Hulec15 - 线性递推关系与生成函数

## 求解线性递推关系

**定义** 具有常数系数的k阶线性齐次关系是形式为
aₙ = c₁aₙ₋₁ + c₂aₙ₋₂ + ··· + cₖaₙ₋ₖ
的递推关系，其中c₁,c₂,...,cₖ是实数，且cₖ≠0。

- **线性**: 它是前几项的线性组合
- **齐次**: 所有项都是aⱼ的倍数
- **阶k**: aₙ由前k项表示
- **常数系数**: 系数是常数

通过归纳法，这样的递推关系由这个递推关系和k个初始条件a₀,a₁,...,aₖ₋₁唯一确定。

## 线性递推关系示例

**定义** 具有常数系数的k阶线性齐次关系是形式为
aₙ = c₁aₙ₋₁ + c₂aₙ₋₂ + ··· + cₖaₙ₋ₖ
的递推关系，其中c₁,c₂,...,cₖ是实数，且cₖ≠0。

**示例**
- Pₙ = (1.11)Pₙ₋₁ （1阶线性齐次递推关系）
- fₙ = fₙ₋₁ + fₙ₋₂ （2阶线性齐次递推关系）
- aₙ = aₙ₋₁ + a²ₙ₋₂ （非线性）
- Hₙ = 2Hₙ₋₁ + 1 （非齐次）
- Bₙ = nBₙ₋₁ （系数不是常数）

## 求解线性递推关系

**示例** 考虑递推关系 aₙ = 2aₙ₋₁ - aₙ₋₂，以下哪些是解？
- aₙ = 3n: ✓
- aₙ = 2ⁿ: ✗
- aₙ = 5: ✓

## 求解线性递推关系

**定义** 具有常数系数的k阶线性齐次关系是形式为
aₙ = c₁aₙ₋₁ + c₂aₙ₋₂ + ··· + cₖaₙ₋ₖ
的递推关系，其中c₁,c₂,...,cₖ是实数，且cₖ≠0。

**基本思想**: 寻找形式为 aₙ = rⁿ 的解，其中r是常数。

- 将 aₙ = rⁿ 带回递推关系: rⁿ = c₁rⁿ⁻¹ + c₂rⁿ⁻² + ··· + cₖrⁿ⁻ᵏ
- rⁿ⁻ᵏ(rᵏ - c₁rᵏ⁻¹ - ··· - cₖ) = 0 即 (rᵏ - c₁rᵏ⁻¹ - ··· - cₖ) = 0
- 特征方程的解可以产生序列的显式公式

## 回忆：问题IV 斐波那契数

F₀ = 0, F₁ = 1, Fₙ = Fₙ₋₁ + Fₙ₋₂ 对于 n≥2

- Fₙ的闭式表达式是什么？
- 考虑 xⁿ = xⁿ⁻¹ + xⁿ⁻²，其中 x≠0。有两个不同的根 φ = (1+√5)/2, ψ = (1-√5)/2
- 那么 Fₙ 可以是形式 aφⁿ + bψⁿ。由 F₀=0 和 F₁=1，我们有 a+b=0 和 φa+ψb=1，得到 a=1/√5, b=-a。因此 Fₙ = (φⁿ - ψⁿ)/√5

## 求解2阶线性递推关系

考虑任意具有常数系数的2阶线性齐次关系: aₙ = c₁aₙ₋₁ + c₂aₙ₋₂

特征方程(CE)是: r² - c₁r - c₂ = 0

**定理** 如果这个CE有2个根 r₁≠r₂，那么序列{aₙ}是递推关系的解当且仅当 aₙ = α₁r₁ⁿ + α₂r₂ⁿ 对于 n≥0 和常数 α₁,α₂

**证明？** 见[定理1 p.515]

## 求解2阶线性递推关系

**示例1** aₙ = aₙ₋₁ + 2aₙ₋₂，其中 a₀=2, a₁=7

r² - r - 2 = 0。特征方程是
两个根是2和-1。所以，假设 aₙ = α₁2ⁿ + α₂(-1)ⁿ

由两个初始条件，我们有
a₀ = α₁ + α₂ = 2
a₁ = 2α₁ - α₂ = 7

我们得到 α₁=3 和 α₂=-1。因此，aₙ = 3·2ⁿ - (-1)ⁿ

## 求解2阶线性递推关系

**示例2** aₙ = 7aₙ₋₁ - 10aₙ₋₂，其中 a₀=2, a₁=1

r² - 7r + 10 = 0。特征方程是
两个根是2和5。所以，假设 aₙ = α₁2ⁿ + α₂5ⁿ

由两个初始条件，我们有
a₀ = α₁ + α₂ = 2
a₁ = 2α₁ + 5α₂ = 1

我们得到 α₁=3 和 α₂=-1。因此，aₙ = 3·2ⁿ - 5ⁿ

## 求解k阶线性递推关系

考虑任意具有常数系数的k阶线性齐次关系: aₙ = ∑ᵢ₌₁ᵏ cᵢaₙ₋ᵢ

特征方程(CE)是: rᵏ - ∑ᵢ₌₁ᵏ cᵢrᵏ⁻ⁱ = 0

**定理** 如果这个CE有k个不同的根 rᵢ，那么递推关系的解形式为 aₙ = ∑ᵢ₌₁ᵏ αᵢrᵢⁿ 对于所有 n≥0，其中 αᵢ 是常数

**示例** aₙ = 2aₙ₋₁ + 5aₙ₋₂ - 6aₙ₋₃

## 退化根的情况

**定理** 如果CE r² - c₁r - c₂ = 0 只有一个根 r₀，那么 aₙ = α₁r₀ⁿ + α₂nr₀ⁿ，对于所有 n≥0 和两个常数 α₁ 和 α₂

**证明？** 练习

## 退化根的情况

**示例** aₙ = 4aₙ₋₁ - 4aₙ₋₂，其中 a₀=1, a₁=0

r² - 4r + 4 = 0。特征方程是
唯一的根是2。所以，假设 aₙ = α₁2ⁿ + α₂n2ⁿ

由两个初始条件，我们有
a₀ = α₁ = 1
a₁ = 2α₁ + 2α₂ = 0

我们得到 α₁=1 和 α₂=-1。因此，aₙ = 2ⁿ - n2ⁿ

## 一般情况下的退化根

**定理**[定理4, p.519] 假设有t个根 r₁,...,rₜ 具有重数 m₁,...,mₜ。那么 aₙ = ∑ᵢ₌₁ᵗ (∑ⱼ₌₀ᵐⁱ⁻¹ αᵢ,ⱼnʲ)rᵢⁿ，对于所有 n≥0 和常数 αᵢ,ⱼ

**示例** aₙ = -3aₙ₋₁ - 3aₙ₋₂ - aₙ₋₃ 其中 a₀=1, a₁=-2, a₂=-1

## 线性非齐次递推关系

**定义** 具有常数系数的线性非齐次关系可能包含一些仅依赖于n的项F(n)
aₙ = c₁aₙ₋₁ + c₂aₙ₋₂ + ··· + cₖaₙ₋ₖ + F(n)

递推关系 aₙ = c₁aₙ₋₁ + c₂aₙ₋₂ + ··· + cₖaₙ₋ₖ 称为相关的齐次递推关系

## 线性非齐次递推关系

**定理** 如果 aₙ = p(n) 是具有常数系数的线性非齐次关系 aₙ = c₁aₙ₋₁ + c₂aₙ₋₂ + ··· + cₖaₙ₋ₖ + F(n) 的任何特解，那么它的所有解形式为 aₙ = p(n) + h(n)，其中 aₙ = h(n) 是相关齐次递推关系 aₙ = c₁aₙ₋₁ + c₂aₙ₋₂ + ··· + cₖaₙ₋ₖ 的任何解

## 求解线性非齐次递推关系

**示例** aₙ = 3aₙ₋₁ + 2n。哪个解有 a₁=3？

相关线性齐次递推关系的特征方程是 r² - 3r = 0。因此，原始问题的所有解形式为 aₙ = α3ⁿ + p(n)

我们尝试一个t次多项式作为特解 p(n)

设 p(n) = cn + d，那么 cn + d = 3(c(n-1) + d) + 2n，这意味着 (2c+2)n + (2d-3c) = 0

我们得到 c=-1 和 d=-3/2。因此，p(n) = -n - 3/2

## 生成函数

我们可以使用生成函数来表征序列。

- 序列{aₖ} 其中 aₖ = 3: ∑ₖ₌₀∞ 3xᵏ
- 序列{aₖ} 其中 aₖ = 2ᵏ: ∑ₖ₌₀∞ 2ᵏxᵏ

**定义** 实数序列 a₀,a₁,...,aₖ,... 的生成函数是无穷级数 G(x) = a₀ + a₁x + ··· + aₖxᵏ + ··· = ∑ₖ₌₀∞ aₖxᵏ

## 有限序列的生成函数

有限序列 a₀,a₁,...,aₙ 可以通过设置 aₙ₊₁ = aₙ₊₂ = ··· = 0 轻松扩展

这个无穷序列{aₙ}的生成函数 G(x) 是n次多项式，即 G(x) = a₀ + a₁x + ··· + aₙxⁿ

- 序列 a₀,a₁,...,aₘ 的生成函数是什么，其中 aₖ = C(m,k)？
G(x) = C(m,0) + ··· + C(m,m)xᵐ = (1+x)ᵐ

## 示例

- G(x) = 1/(1-x) 对于 |x|<1: 1,1,1,1,1,...
- G(x) = 1/(1-ax) 对于 |ax|<1: 1,a,a²,a³,a⁴,...
- G(x) = 1/(1-x)² 对于 |x|<1: 1,2,3,4,5,...

## 生成函数的运算

**定理** 设 f(x) = ∑ₖ₌₀∞ aₖxᵏ，且 g(x) = ∑ₖ₌₀∞ bₖxᵏ。那么
f(x) + g(x) = ∑ₖ₌₀∞ (aₖ + bₖ)xᵏ
f(x)g(x) = ∑ₖ₌₀∞ (∑ⱼ₌₀ᵏ aⱼbₖ₋ⱼ)xᵏ

- G(x) = 1/(1-x)² 对于 |x|<1
f(x) = 1/(1-x), g(x) = 1/(1-x)
G(x) = f(x)g(x) = ∑ₖ₌₀∞ (∑ⱼ₌₀ᵏ 1)xᵏ = ∑ₖ₌₀∞ (k+1)xᵏ

## 生成函数的运算

**定理** 设 f(x) = ∑ₖ₌₀∞ aₖxᵏ，且 g(x) = ∑ₖ₌₀∞ bₖxᵏ。那么
f(x) + g(x) = ∑ₖ₌₀∞ (aₖ + bₖ)xᵏ
f(x)g(x) = ∑ₖ₌₀∞ (∑ⱼ₌₀ᵏ aⱼbₖ₋ⱼ)xᵏ

- G(x) = 1/(1-ax)² 对于 |x|<1
f(x) = 1/(1-ax), g(x) = 1/(1-ax)
G(x) = f(x)g(x) = ∑ₖ₌₀∞ (∑ⱼ₌₀ᵏ aⱼaᵏ⁻ⱼ)xᵏ = ∑ₖ₌₀∞ (k+1)aᵏxᵏ

## 有用的生成函数

(1+x)ⁿ = ∑ₖ₌₀ⁿ C(n,k)xᵏ
(1+ax)ⁿ = ∑ₖ₌₀ⁿ C(n,k)aᵏxᵏ
(1+xʳ)ⁿ = ∑ₖ₌₀ⁿ C(n,k)xʳᵏ

(1-xⁿ⁺¹)/(1-x) = ∑ₖ₌₀ⁿ xᵏ = 1 + x + x² + ··· + xⁿ
1/(1-x) = ∑ₖ₌₀∞ xᵏ = 1 + x + x² + ···
1/(1-ax) = ∑ₖ₌₀∞ aᵏxᵏ = 1 + ax + a²x² + ···
1/(1-xʳ) = ∑ₖ₌₀∞ xʳᵏ = 1 + xʳ + x²ʳ + ···

1/(1-x)² = ∑ₖ₌₀∞ (k+1)xᵏ = 1 + 2x + 3x² + ···

## 有用的生成函数

1/(1-x)ⁿ = ∑ₖ₌₀∞ C(n+k-1,k)xᵏ
1/(1+x)ⁿ = ∑ₖ₌₀∞ C(n+k-1,k)(-1)ᵏxᵏ
1/(1-ax)ⁿ = ∑ₖ₌₀∞ C(n+k-1,k)aᵏxᵏ

eˣ = ∑ₖ₌₀∞ xᵏ/k! = 1 + x + x²/2! + x³/3! + ···
ln(1+x) = ∑ₖ₌₀∞ (-1)ᵏ⁺¹xᵏ/k = x - x²/2 + x³/3 - x⁴/4 + ···

## 计数和生成函数

**问题2** 求 x₁ + x₂ + x₃ = 17 的解数，其中 x₁,x₂,x₃ 是非负整数，满足 2≤x₁≤5, 3≤x₂≤6, 4≤x₃≤7

使用生成函数，这个数是 (x²+x³+x⁴+x⁵)(x³+x⁴+x⁵+x⁶)(x⁴+x⁵+x⁶+x⁷) 展开式中 x¹⁷ 的系数

## 计数和生成函数

**问题3** 有多少种方式可以将8个相同的饼干分给3个不同的孩子，如果每个孩子至少得到2个饼干且不超过4个饼干？

(x²+x³+x⁴)³ 展开式中 x⁸ 的系数

## 计数和生成函数

**问题4** 使用生成函数求n元素集合的k组合数 C(n,k)

集合中的每个n个元素对生成函数 f(x) = ∑ₖ₌₀ⁿ aₖxᵏ 贡献项 (1+x)。因此，f(x) = (1+x)ⁿ。然后由二项式定理，我们有 aₖ = (n选k)

## 下节课内容
- 关系

## 相关知识点总结
- [[计数原理与组合数学]] - 计数原理与组合数学知识分块总结
- [[离散数学总览]] - 离散数学整体概述
