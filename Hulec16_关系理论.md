# Hulec16 - 关系理论

## 生成函数

我们可以使用生成函数来表征序列。

- 序列 {aₖ} 其中 aₖ = 3
∑ₖ₌₀∞ 3xᵏ

- 序列 {aₖ} 其中 aₖ = 2ᵏ
∑ₖ₌₀∞ 2ᵏxᵏ

**定义** 实数序列 a₀, a₁, ..., aₖ, ... 的生成函数是无穷级数
G(x) = a₀ + a₁x + ··· + aₖxᵏ + ··· = ∑ₖ₌₀∞ aₖxᵏ

## 笛卡尔积

设 A = {a₁, a₂, ..., aₘ} 和 B = {b₁, b₂, ..., bₙ}，笛卡尔积 A × B 是成对的集合
{(a₁, b₁), (a₂, b₂), ..., (a₁, bₙ), ..., (aₘ, bₙ)}

笛卡尔积定义了两个集合中元素的所有有序排列的集合。

## 二元关系

**定义**: 设 A 和 B 是两个集合。从 A 到 B 的二元关系是笛卡尔积 A × B 的子集。

设 R ⊆ A × B 表示 R 是形式为 (a, b) 的有序对的集合，其中 a ∈ A 且 b ∈ B。

我们使用符号 aRb 表示 (a, b) ∈ R，而 a/Rb 表示 (a, b) ∉ R。

**示例**: 设 A = {a, b, c} 和 B = {1, 2, 3}
- R = {(a,1), (b,2), (c,2)} 是从 A 到 B 的关系吗？ ✓
- Q = {(1,a), (2,b)} 是从 A 到 B 的关系吗？ ✗
- P = {(a,a), (b,c), (b,a)} 是从 A 到 A 的关系吗？ ✓

## 表示二元关系

我们可以图形化地表示二元关系 R：如果 aRb，那么我们从 a 到 b 画一个箭头：a → b

**示例**: 设 A = {0,1,2} 和 B = {u,v}，且 R = {(0,u), (0,v), (1,v), (2,u)} (R ⊆ A × B)

```
0 ---→ u
  \
   ---→ v
1 ---→ v
2 ---→ u
```

## 表示二元关系

我们还可以通过显示 R 的有序对的表格来表示二元关系 R。

**示例**: 设 A = {0,1,2} 和 B = {u,v}，且 R = {(0,u), (0,v), (1,u), (2,v)} (R ⊆ A × B)

|   | u | v |
|---|---|---|
| 0 | ✓ | ✓ |
| 1 | ✓ |   |
| 2 |   | ✓ |

## 关系和函数

关系表示 A 和 B 中元素之间的一对多关系。

```
0 ---→ u
  \
   ---→ v
1 ---→ v
2 ---→ u
```

从 A 到 B 的关系和函数之间有什么区别？

## 集合上的关系

**定义**: 集合 A 上的关系是从 A 到自身的关系。

**示例**: 设 A = {1,2,3,4} 且 R_div = {(a,b): a|b}。R_div 包含什么？

R_div = {(1,1), (1,2), (1,3), (1,4), (2,2), (2,4), (3,3), (4,4)}

## 二元关系的数量

**定理** 集合 A 上的二元关系数，其中 |A| = n，是 2ⁿ²

**证明** 如果 |A| = n，那么笛卡尔积 |A × A| = n²。
R 是 A 上的二元关系如果 R ⊆ A × A (R 是子集)
具有 k 个元素的集合的子集数是 2ᵏ

## 关系的性质

**自反关系**: 集合 A 上的关系 R 称为自反的，如果对于每个元素 a ∈ A，都有 (a,a) ∈ R。

**示例**: 假设 R_div = {(a,b): a|b} 在 A = {1,2,3,4} 上。
R_div = {(1,1), (1,2), (1,3), (1,4), (2,2), (2,4), (3,3), (4,4)}
R_div 是自反的吗？ ✓ (1,1), (2,2), (3,3), (4,4) ∈ R_div

## 自反关系

**示例**: 假设 R_div = {(a,b): a|b} 在 A = {1,2,3,4} 上。
R_div = {(1,1), (1,2), (1,3), (1,4), (2,2), (2,4), (3,3), (4,4)}

关系 R 是自反的当且仅当 M_R 在其主对角线的每个位置都有 1。

## 自反关系

**示例**: 假设 R = {(1,2), (2,2), (3,3)} 在 A = {1,2,3,4} 上。
R 是自反的吗？ ✗ (1,1) ∉ R

## 关系的性质

**反自反关系**: 集合 A 上的关系 R 称为反自反的，如果对于每个元素 a ∈ A，都有 (a,a) ∉ R。

**示例**: 假设 R_≠ = {(a,b): a ≠ b} 在 A = {1,2,3,4} 上。
R_≠ = {(1,2), (1,3), (1,4), (2,1), (2,3), (2,4), (3,1), (3,2), (3,4), (4,1), (4,2), (4,3)}
R_≠ 是反自反的吗？ ✓ (1,1), (2,2), (3,3), (4,4) ∉ R_≠

## 反自反关系

**示例**: 假设 R_≠ = {(a,b): a ≠ b} 在 A = {1,2,3,4} 上。
R_≠ = {(1,2), (1,3), (1,4), (2,1), (2,3), (2,4), (3,1), (3,2), (3,4), (4,1), (4,2), (4,3)}

关系 R 是反自反的当且仅当 M_R 在其主对角线的每个位置都有 0。

## 关系的性质

**对称关系**: 集合 A 上的关系 R 称为对称的，如果对于所有 a,b ∈ A，只要 (a,b) ∈ R，就有 (b,a) ∈ R。

**示例**: 假设 R_div = {(a,b): a|b} 在 A = {1,2,3,4} 上。
R_div = {(1,1), (1,2), (1,3), (1,4), (2,2), (2,4), (3,3), (4,4)}
R_div 是对称的吗？ ✗ (1,2) ∈ R_div 但 (2,1) ∉ R_div

## 对称关系

**示例**: 假设 R_≠ = {(a,b): a ≠ b} 在 A = {1,2,3,4} 上。
R_≠ = {(1,2), (1,3), (1,4), (2,1), (2,3), (2,4), (3,1), (3,2), (3,4), (4,1), (4,2), (4,3)}
R_≠ 是对称的吗？ ✓ 如果 (a,b) ∈ R_≠ 那么 (b,a) ∈ R_≠

关系 R 是对称的当且仅当 M_R 是对称的。

## 关系的性质

**反对称关系**: 集合 A 上的关系 R 称为反对称的，如果对于所有 a,b ∈ A，(b,a) ∈ R 且 (a,b) ∈ R 蕴含 a = b。

**示例**: 假设 R = {(1,2), (2,2), (3,3)} 在 A = {1,2,3,4} 上。
R 是反对称的吗？ ✓

## 反对称关系

**示例**: 假设 R = {(1,2), (2,2), (3,3)} 在 A = {1,2,3,4} 上。

关系 R 是反对称的当且仅当对于 i ≠ j，m_ij = 1 蕴含 m_ji = 0。

## 反对称关系

**示例**: 假设 R_div = {(a,b): a|b} 在 A = {1,2,3,4} 上。
R_div = {(1,1), (1,2), (1,3), (1,4), (2,2), (2,4), (3,3), (4,4)}
R_div 是反对称的吗？ ✓ 如果 a|b 且 b|a，那么 a = b。

## 关系的性质

**传递关系**: 集合 A 上的关系 R 称为传递的，如果对于所有 a,b,c ∈ A，(a,b) ∈ R 且 (b,c) ∈ R 蕴含 (a,c) ∈ R。

**示例**: 假设 R_div = {(a,b): a|b} 在 A = {1,2,3,4} 上。
R_div = {(1,1), (1,2), (1,3), (1,4), (2,2), (2,4), (3,3), (4,4)}
R_div 是传递的吗？ ✓ 如果 a|b 且 b|c，那么 a|c。

## 传递关系

**示例**: 假设 R_≠ = {(a,b): a ≠ b} 在 A = {1,2,3,4} 上。
R_≠ = {(1,2), (1,3), (1,4), (2,1), (2,3), (2,4), (3,1), (3,2), (3,4), (4,1), (4,2), (4,3)}
R_≠ 是传递的吗？ ✗ (1,2) ∈ R_≠ 且 (2,1) ∈ R_≠ 但 (1,1) ∉ R_≠

## 关系的组合

**定义** 设 R 是从 A 到 B 的关系，S 是从 B 到 C 的关系。R 和 S 的组合，记作 S ∘ R，是从 A 到 C 的关系，定义为：
S ∘ R = {(a,c) ∈ A × C | 存在 b ∈ B 使得 (a,b) ∈ R 且 (b,c) ∈ S}

**示例**: 设 A = {1,2,3}, B = {0,1,2}, C = {a,b,c}
R = {(1,0), (1,1), (2,2), (3,0), (3,1)}
S = {(0,b), (1,a), (2,b), (2,c)}
那么 S ∘ R = {(1,a), (1,b), (2,b), (2,c), (3,a), (3,b)}

## 关系的幂

**定义** 设 R 是集合 A 上的关系。R 的幂定义为：
- R¹ = R
- Rⁿ⁺¹ = Rⁿ ∘ R

**示例**: 设 A = {1,2,3,4} 且 R = {(1,2), (2,2), (2,3)}
R² = R ∘ R = {(1,2), (1,3), (2,2), (2,3)}
R³ = R² ∘ R = {(1,2), (1,3), (2,2), (2,3)}

## 传递关系和 Rⁿ

**定理** 集合 A 上的关系 R 是传递的当且仅当对于 n = 1,2,3,...，有 Rⁿ ⊆ R

**证明**:
"如果"部分: 特别地，R² ⊆ R。
如果 (a,b) ∈ R 且 (b,c) ∈ R，那么根据组合的定义，我们有 (a,c) ∈ R² ⊆ R。
"仅当"部分: 通过归纳法。

## 自反关系的数量

**定理** 集合 A 上的自反关系数，其中 |A| = n，是 2ⁿ⁽ⁿ⁻¹⁾

**证明** A 上的自反关系 R 必须包含所有对 (a,a)，对于每个 a ∈ A。
R 中的所有其他对都是形式为 (a,b) 且 a ≠ b 的对，其中 a,b ∈ A。
这样的对有多少个？
具有 n(n-1) 个元素的集合有多少个子集？

## 关系性质总结

**自反关系**: 集合 A 上的关系 R 称为自反的，如果对于每个元素 a ∈ A，都有 (a,a) ∈ R。

**反自反关系**: 集合 A 上的关系 R 称为反自反的，如果对于每个元素 a ∈ A，都有 (a,a) ∉ R。

**对称关系**: 集合 A 上的关系 R 称为对称的，如果对于所有 a,b ∈ A，只要 (a,b) ∈ R，就有 (b,a) ∈ R。

**反对称关系**: 集合 A 上的关系 R 称为反对称的，如果对于所有 a,b ∈ A，(b,a) ∈ R 且 (a,b) ∈ R 蕴含 a = b。

**传递关系**: 集合 A 上的关系 R 称为传递的，如果对于所有 a,b,c ∈ A，(a,b) ∈ R 且 (b,c) ∈ R 蕴含 (a,c) ∈ R。

## n元关系

**定义** 集合 A₁, ..., Aₙ 上的 n 元关系 R，写作 R: A₁, ..., Aₙ，是子集 R ⊆ A₁ × ··· × Aₙ。

- 集合 Aᵢ 称为 R 的定义域
- R 的度是 n
- 如果对于定义域 Aᵢ 中的任何值 aᵢ，R 最多包含一个 n 元组 (···, aᵢ, ···)，则 R 在定义域 Aᵢ 中是函数的

## 关系数据库

关系数据库本质上是一个 n 元关系 R。

- 如果关系 R 在 Aᵢ 中是函数的，则定义域 Aᵢ 是数据库的主键
- 数据库的复合键是定义域集合 {Aᵢ, Aⱼ, ···}，使得对于每个复合值 (aᵢ, aⱼ, ···) ∈ Aᵢ × Aⱼ × ···，R 最多包含 1 个 n 元组 (···, aᵢ, ···, aⱼ, ···)

在 ER 图中有如下四个成分：
1）矩形框：表示实体，在框中记入实体名。
2）菱形框：表示联系，在框中记入联系名
3）椭圆形框：表示实体或联系的属性。
4）连线：实体与属性之间；

## 选择操作符

设 A 是任何 n 元定义域 A = A₁ × ··· × Aₙ，且设 C: A → {T,F} 是 A 的元素（n 元组）上的任何条件（谓词）。

选择操作符 s_C 是将任何（n 元）关系 R 映射到满足 C 的来自 R 的所有 n 元组的 n 元关系的操作符。

∀ R ⊆ A, s_C(R) = R ∩ {a ∈ A | s_C(a) = T} = {a ∈ R | s_C(a) = T}

## 选择操作符示例

假设我们有一个定义域 A = StudentName × Standing × SocSecNos

假设我们有一个定义域 UpperLevel(name, standing, ssn): ≡ [(standing = junior) ∨ (standing = senior)]

那么 s_UpperLevel 是选择操作符，它接受 A 上的任何关系 R（学生数据库）并生成仅包含高年级班级（大三和大四）的关系。

## 投影操作符

设 A = A₁ × ··· × Aₙ 是任何 n 元定义域，且设 {iₖ} = (i₁, ..., iₘ) 是索引序列，所有索引都落在 1 到 n 的范围内。即，对于所有 1 ≤ k ≤ m，有 1 ≤ iₖ ≤ n。

那么 n 元组上的投影操作符 P_{iₖ}: A → A_{i₁} × ··· × A_{iₘ} 定义为
P_{iₖ}(a₁, ···, aₙ) = (a_{i₁}, ···, a_{iₘ})

## 投影示例

假设我们有一个三元定义域 Cars = Model × Year × Color (n = 3)

考虑索引序列 {iₖ} = {1,3} (m = 2)

那么投影 P_{iₖ} 简单地将每个元组 (a₁, a₂, a₃) = (model, year, color) 映射到其图像：
(a_{i₁}, a_{i₂}) = (a₁, a₃) = (model, color)

这个操作符可以有效地应用于整个关系 R ⊆ Cars（汽车数据库）以获得可用的型号/颜色组合列表。

## 连接操作符

将两个关系放在一起形成一种组合关系。

如果元组 (A,B) 出现在 R₁ 中，且元组 (B,C) 出现在 R₂ 中，那么元组 (A,B,C) 出现在连接 J(R₁,R₂) 中。

A,B,C 也可以是元素序列而不是单个元素。

## 连接示例

假设 R₁ 是一个教学分配表，将教授与课程关联起来。

假设 R₂ 是一个房间分配表，将课程与房间和时间关联起来。

那么 J(R₁,R₂) 就像你的课程表，列出（教授，课程，房间，时间）。

## 下节课内容
- 关系 II

## 相关知识点总结
- [[图论与关系]] - 图论与关系知识分块总结
- [[离散数学总览]] - 离散数学整体概述
