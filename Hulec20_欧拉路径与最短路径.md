# Hulec20 - 欧拉路径与最短路径

## 图概念

G = (V,E)，简单图，多重图，伪图
无向图，有向图
特殊图 Kₙ, Cₙ, Wₙ, Qₙ, Kₘ,ₙ
二分图上的 Hall 婚姻定理
图的表示：邻接表，邻接矩阵，关联矩阵

## 图的同构

**定义** 简单图 G₁ = (V₁,E₁) 和 G₂ = (V₂,E₂) 是同构的，如果存在从 V₁ 到 V₂ 的一一对应函数，使得对于 V₁ 中的所有 a 和 b，a 和 b 在 G₁ 中相邻当且仅当 f(a) 和 f(b) 在 G₂ 中相邻。这样的函数称为同构。

有用的图不变量包括顶点数、边数、度序列等。

## 割点和割边

有时从图中移除一个顶点和所有关联的边会使图断开连接。这样的顶点称为割点。类似地，我们可以定义割边。

边集 E₀ 称为 G 的边割，如果子图 G \ E₀ 是断开的。边连通度 κ(G) 是 G 的边割中的最小边数。

## 顶点间路径计数

**定理** 设 G 是相对于顶点排序 v₁, v₂, ..., vₙ 具有邻接矩阵 A 的图。从 vᵢ 到 vⱼ 的长度为 r 的不同路径数（其中 r > 0 为正数）等于 Aʳ 的第 (i,j) 项。

**证明** (通过归纳法)
Aʳ⁺¹ = AʳA，Aʳ⁺¹ 的第 (i,j) 项等于 bᵢ₁a₁ⱼ + bᵢ₂a₂ⱼ + ··· + bᵢₙaₙⱼ，其中 bᵢₖ 是 Aʳ 的第 (i,k) 项。

## 顶点间路径计数

**示例** 图 G 中从 a 到 d 的长度为 4 的路径有多少条？

## 欧拉路径

柯尼斯堡七桥问题
人们想知道是否有可能从城镇的某个位置出发，穿过所有桥梁一次而不经过任何桥梁两次，并返回起点。

## 欧拉路径和回路

**定义** 图 G 中的欧拉回路是包含 G 的每条边的简单回路。G 中的欧拉路径是包含 G 的每条边的简单路径。

**示例** 哪些无向图有欧拉回路？那些没有的，哪些有欧拉路径？

## 欧拉路径和回路

**定义** 图 G 中的欧拉回路是包含 G 的每条边的简单回路。G 中的欧拉路径是包含 G 的每条边的简单路径。

**示例** 哪些有向图有欧拉回路？那些没有的，哪些有欧拉路径？

## 欧拉回路和路径的必要条件

欧拉回路) 每个顶点的度必须是偶数
- 每次回路通过一个顶点时，它对顶点的度贡献两次。
- 回路以顶点 a 开始并以 a 结束，然后对 deg(a) 贡献两次。

欧拉路径) 图恰好有两个奇数度的顶点
- 欧拉路径的初始顶点和最终顶点具有奇数度。

## 欧拉回路和路径的充分条件

假设 G 是具有 ≥ 2 个顶点的连通多重图，所有顶点的度都是偶数。

## 必要和充分条件

**定理** 具有至少两个顶点的连通多重图有欧拉回路当且仅当它的每个顶点都有偶数度。

**定理** 连通多重图有欧拉路径但没有欧拉回路当且仅当它恰好有两个奇数度的顶点。

没有欧拉回路

## 欧拉回路和路径

**示例**

## 欧拉路径和回路的应用

找到遍历每个的路径或回路：
- 邻域中的街道
- 交通网络中的道路
- 通信网络中的链接
- ...

中国邮递员问题 管梅谷 [60年代]

给定图 G = (V,E)，对于每个 e ∈ E，有一个非负权重 w(e)。找到回路 W 使得 ∑ₑ∈w w(e) = min

k-邮递员中国邮递员问题 (k-PCPP)
2NPC

## 哈密顿路径和回路

欧拉路径和回路包含每条边仅一次。包含每个顶点恰好一次呢？

## 哈密顿路径和回路

**定义**: 图 G 中恰好经过每个顶点一次的简单路径称为哈密顿路径，图 G 中恰好经过每个顶点一次的简单回路称为哈密顿回路。

**示例** 这些简单图中哪些有哈密顿回路？如果没有，哪些有哈密顿路径？

## 哈密顿回路的充分条件

对于哈密顿回路的存在，没有已知的简单必要和充分条件。

但是，有一些有用的充分条件。

**Dirac 定理** 如果 G 是具有 n ≥ 3 个顶点的简单图，使得 G 中每个顶点的度 ≥ n/2，那么 G 有哈密顿回路。

**Ore 定理** 如果 G 是具有 n ≥ 3 个顶点的简单图，使得对于每对不相邻顶点，deg(u) + deg(v) ≥ n，那么 G 有哈密顿回路。

哈密顿路径问题 2NPC

## 哈密顿路径和回路的应用

访问每个城市或通信网络中每个节点恰好一次的路径或回路可以通过找到哈密顿路径来解决。

旅行商问题 (TSP) 询问旅行商应该采取的最短路线来访问一组城市。

TSP 的决策版本 2NPC

## 哈密顿路径和回路的应用

我们能否遍历 5×5 棋盘中的每个空格（并返回）？
6×6 棋盘呢？

## 最短路径问题

使用边分配权重的图

这样的图称为加权图，可以模拟涉及距离、时间消耗、费用等的许多问题。

## 最短路径问题

**定义** 设 G_α 是加权图，其边上具有权重函数 α: E → R⁺。如果 P = e₁e₂···eₖ 是路径，那么它的权重是 α(P) = ∑ᵢ₌₁ᵏ α(eᵢ)。两个顶点之间的最小加权距离是 d(u,v) = min{α(P) | P: u → v}

## Dijkstra 算法

(i) 设 d(v₀) = 0 且对于所有 v ≠ v₀，d(v) = ∞，S = ∅

(ii) 当 S ≠ V
    令 v ∉ S 是具有最小值 d(v) 的顶点，S = S ∪ {v}
    对于每个 u ∉ S，将 d(u) 替换为 min{d(u), d(v) + α(u,v)}

(iii) 返回所有 d(v)

## Dijkstra 算法

**示例**
d(v₀) = 0，所有其他 d(v) = ∞
v₀ v₁ v₂ v₃ v₄ v₅
0 ∞ ∞ ∞ ∞ ∞

i = 0 d(v₁) = min{∞, 2} = 2, d(v₂) = min{∞, 3} = 3
v₀ v₁ v₂ v₃ v₄ v₅
0 2 3 ∞ ∞ ∞

i = 1 d(v₂) = min{3, d(v₁) + α(v₁v₂)} = min{3, 4} = 3, d(v₃) = 2+1 = 3, d(v₄) = 2+3 = 5, d(v₅) = 2+2 = 4
v₀ v₁ v₂ v₃ v₄ v₅
0 2 3 3 5 4

i = 2 d(v₃) = min{3, 1} = 3, d(v₄) = min{5, 3+1} = 4, d(v₅) = min{4, 1} = 4
v₀ v₁ v₂ v₃ v₄ v₅
0 2 3 3 4 4

i = 3 d(v₄) = min{4, 3+2} = 4, d(v₅) = min{4, 3+1} = 4
v₀ v₁ v₂ v₃ v₄ v₅
0 2 3 3 4 4

i = 4 d(v₅) = min{4, 4+2} = 4
v₀ v₁ v₂ v₃ v₄ v₅
0 2 3 3 4 4

## Dijkstra 算法

**定理** Dijkstra 算法找到连通简单无向加权图中两个顶点之间最短路径的长度。

正确性

**定理** 在具有 n 个顶点的连通简单无向加权图中，Dijkstra 算法使用 O(n²) 次操作（加法和比较）。

复杂度

## 另一个示例

a b c e f d
4 2 1 5 10 8 2 6 3 2

## 下节课内容
- 图论 III

## 相关知识点总结
- [[图论与关系]] - 图论与关系知识分块总结
- [[离散数学总览]] - 离散数学整体概述
