# Hulec12 - 递推关系与数学归纳法

## 数学归纳法

我们通过回顾最小反例证明来尝试理解它真正在做什么。这引导我们将反例证明的间接证明转化为直接证明。这种直接证明技术将是归纳法。我们通过区分弱数学归纳法原理和强数学归纳法原理来结束。强原理实际上可以从弱原理推导出来。

## 最小反例证明法

陈述P(n)对所有n=0,1,2,...为真。我们通过以下方式证明这一点：
(i) 假设存在反例，即存在某个n>0使得P(n)为假
(ii) 设m>0是使得P(n)为假的最小值
(iii) 然后使用对所有0≤m'<m，P(m')为真的事实来证明P(m)为真，与m的选择矛盾。矛盾！

## 示例1

使用最小反例证明法证明，∀n∈ℕ，(∗) 0+1+2+3+···+n = n(n+1)/2

- 假设(∗)不总是为真
- 那么必须存在最小的n∈ℕ使得(∗)对n不成立
- 对于任何非负整数i<n，1+2+···+i = i(i+1)/2
- 由于0=0·1/2，(∗)对n=0成立
- 最小反例n大于0

## 示例1

我们现在有(i)最小反例n大于0，且(ii)(∗)对n-1成立
- 将n-1代入i得到1+2+···+n-1 = (n-1)n/2
- 两边加上n得到1+2+···+n-1+n = (n-1)n/2 + n = n(n+1)/2
- 因此，n不是反例。矛盾！
- 所以，(∗)对所有正整数n成立

## 示例1

我们必须证明什么蕴含关系？关键步骤是证明P(n-1)→P(n)，其中P(n)是陈述1+2+···+n = n(n+1)/2

## 示例2

使用最小反例证明法证明，∀n∈ℕ，2ⁿ⁺¹ ≥ n²+2。

设P(n) – 2ⁿ⁺¹ ≥ n²+2。我们首先假设陈述∀n∈ℕ P(n)为假。当全称量词为假时，必须存在某个n使得它为假。设n是使得2ⁿ⁺¹ ≱ n²+2的最小非负整数。

## 示例2

设n是使得2ⁿ⁺¹ ≱ n²+2的最小非负整数。这意味着，对于所有i∈ℕ且i<n，2ⁱ⁺¹ ≥ i²+2。

由于2⁰⁺¹ ≥ 0²+2，我们知道n>0。因此，n-1是小于n的非负整数。然后设i=n-1得到2⁽ⁿ⁻¹⁾⁺¹ ≥ (n-1)²+2。或(∗) 2ⁿ ≥ n²-2n+1+2 = n²-2n+3

## 示例2

设n是使得2ⁿ⁺¹ ≱ n²+2的最小非负整数。我们现在已知2ⁿ ≥ n²-2n+3。(∗)

两边乘以2，得到2ⁿ⁺¹ = 2·2ⁿ ≥ 2·(n²-2n+3) = 2n²-4n+6。

为了得到矛盾，我们想将右边转换为n²+2加上一个额外的非负项。因此，我们写2ⁿ⁺¹ ≥ 2n²-4n+6 = (n²+2)+(n²-4n+4) = n²+2+(n-2)² ≥ n²+2。矛盾！

## 示例2

设P(n) – 2ⁿ⁺¹ ≥ n²+2
我们刚刚证明了：
(a) P(0)为真
(b) 如果n>0，那么P(n-1)→P(n)
- 假设存在某个n使得P(n)为假(∗)
- 设n为最小反例
- 那么，从(a)得n>0，所以P(n-1)为真
- 因此，从(b)，使用直接推理，P(n)为真
- 这与(∗)矛盾。
- 所以，P(n)对所有n∈ℕ为真

## 示例2

我们真正做了什么？设P(n) – 2ⁿ⁺¹ ≥ n²+2
我们刚刚证明了：
(a) P(0)为真
(b) 如果n>0，那么P(n-1)→P(n)
然后我们使用最小反例证明法推导出P(n)对所有n∈ℕ为真。这是一个间接证明。是否可能直接证明这个事实？由于P(n-1)→P(n)，我们看到P(0)蕴含P(1)，P(1)蕴含P(2)，...

## 数学归纳法原理

良序原理允许我们假设任何非负整数集合都有最小元素，允许我们使用最小反例。这实际上等价于数学归纳法原理。

**原理**（弱数学归纳法原理）
(a) 如果陈述P(b)为真
(b) 陈述P(n-1)→P(n)对所有n>b为真
那么P(n)对所有整数n≥b为真

## 数学归纳法原理

良序原理允许我们假设任何非负整数集合都有最小元素，允许我们使用最小反例。这实际上等价于数学归纳法原理。

**原理**（弱数学归纳法原理）
(a) 如果陈述P(b)为真
(b) 陈述P(n-1)→P(n)对所有n>b为真
那么P(n)对所有整数n≥b为真

(a) – 基础步骤
(b) – 归纳步骤
归纳假设
归纳结论

## 归纳法证明

∀n≥0，2ⁿ⁺¹ ≥ n²+2
设P(n) – 2ⁿ⁺¹ ≥ n²+2

(i) 注意对于n=0，2⁰⁺¹=2≥2=0²+2 – P(0)
(ii) 假设n>0且2ⁿ ≥ (n-1)²+2 (∗)
2ⁿ⁺¹ ≥ 2(n-1)²+4 = (n²+2)+(n²-4n+4) = n²+2+(n-2)² ≥ n²+2

因此，我们刚刚证明了对于n>0，P(n-1)→P(n)。通过数学归纳法，∀n>0，2ⁿ⁺¹ ≥ n²+2。

## 归纳法证明

∀n≥2，2ⁿ⁺¹ ≥ n²+3
设P(n) – 2ⁿ⁺¹ ≥ n²+3

(i) 注意对于n=2，2²⁺¹=8≥7=2²+3 – P(2)
(ii) 假设n>2且2ⁿ ≥ (n-1)²+3 (∗)
2ⁿ⁺¹ ≥ 2(n-1)²+6 = n²+3+n²-4n+4+1 = n²+3+(n-2)²+1 > n²+3

因此，我们刚刚证明了对于n>2，P(n-1)→P(n)。通过数学归纳法，∀n>2，2ⁿ⁺¹ ≥ n²+3。

## 归纳法证明

∀n≥2，2ⁿ⁺¹ ≥ n²+3
设P(n) – 2ⁿ⁺¹ ≥ n²+3

(i) 注意对于n=2，2²⁺¹=8≥7=2²+3 – P(2)
(ii) 假设n>2且2ⁿ ≥ (n-1)²+3 (∗)
2ⁿ⁺¹ ≥ 2(n-1)²+6 = n²+3+n²-4n+4+1 = n²+3+(n-2)²+1 > n²+3

因此，我们刚刚证明了对于n>2，P(n-1)→P(n)。通过数学归纳法，∀n>2，2ⁿ⁺¹ ≥ n²+3。

基础步骤
归纳假设
归纳步骤
归纳结论

## 归纳法的另一种形式

我们可能有另一种形式的直接证明如下：
- 首先假设我们有P(0)的证明
- 接下来假设我们有证明，∀k>0，P(0)∧P(1)∧P(2)∧···∧P(k-1)→P(k)
- 那么，P(0)蕴含P(1)
P(0)∧P(1)蕴含P(2)
P(0)∧P(1)∧P(2)蕴含P(3)
...
- 迭代给出对所有n的P(n)的证明

## 强归纳法原理

**原理**（强数学归纳法原理）
(a) 如果陈述P(b)为真
(b) 对所有n>b，陈述P(b)∧P(b+1)∧···∧P(n-1)→P(n)为真。
那么P(n)对所有整数n≥b为真。

## 示例

证明每个正整数是素数的幂或素数幂的乘积。
- 基础步骤：1是素数的幂，1=2⁰
- 归纳假设：假设每个小于n的数是素数的幂或素数幂的乘积。
- 那么，如果n不是素数幂，它是两个较小数的乘积，每个数根据归纳假设是素数的幂或素数幂的乘积。
- 因此，通过强数学归纳法原理，每个正整数是素数的幂或素数幂的乘积。

## 数学归纳法

在实践中，我们通常不明确区分弱形式和强形式。实际上，它们是等价的，因为弱形式是强形式的特例，而强形式可以从弱形式推导出来。

## 总结

典型的数学归纳法证明，显示陈述P(n)对所有整数n≥b为真，包括三个步骤：
1. 我们证明P(b)为真。– 基础步骤
2. 然后，∀n>b，我们证明要么(∗) P(n-1)→P(n) 要么(∗∗) P(b)∧P(b+1)∧···∧P(n-1)→P(n)
我们需要做出P(n-1)或P(b)∧P(b+1)∧···∧P(n-1)的归纳假设。然后我们使用(∗)或(∗∗)推导出P(n)。
3. 我们基于数学归纳法原理得出结论，P(n)对所有n≥b为真。

## 递推关系

定义在整数集≥b上的函数的递推方程或递推关系是告诉我们如何从前n-1个值中的一些或全部计算第n个值的方程。为了基于递推完全指定函数，我们必须给出递推的初始条件（也称为基本情况）。

M(n) = 
- 1 如果 n=1
- 2M(n-1)+1 否则
（汉诺塔问题）

F(n) = 
- 1 如果 n=0,1
- F(n-1)+F(n-2) 否则
（斐波那契数列）

## 递推关系

**示例2**: 设S(n)是大小为n的集合的子集数。S(n)的公式是什么？

空集，大小为n=0，只有一个子集（它自己），所以S(0)=1。不难看出S(1)=2，S(2)=4，S(3)=8

我们"猜测"S(n)=2ⁿ。但是，为了证明公式，我们需要递归地思考。

## 递推关系

考虑{1,2,3}的八个子集：∅, {1}, {2}, {1,2}, {3}, {1,3}, {2,3}, {1,2,3}

∅ {1} {2} {1,2} {3} {1,3} {2,3} {1,2,3}

前四个子集正好是{1,2}的子集，而后四个是{1,2}的子集，每个都添加了3。

## 递推关系

考虑{1,2,3}的八个子集：∅, {1}, {2}, {1,2}, {3}, {1,3}, {2,3}, {1,2,3}

∅ {1} {2} {1,2} {3} {1,3} {2,3} {1,2,3}

前四个子集正好是{1,2}的子集，而后四个是{1,2}的子集，每个都添加了3。

所以，我们通过取{1,2}的子集或通过将3添加到{1,2}的子集来得到{1,2,3}的子集。

## 递推关系

考虑{1,2,3}的八个子集：∅, {1}, {2}, {1,2}, {3}, {1,3}, {2,3}, {1,2,3}

∅ {1} {2} {1,2} {3} {1,3} {2,3} {1,2,3}

前四个子集正好是{1,2}的子集，而后四个是{1,2}的子集，每个都添加了3。

所以，我们通过取{1,2}的子集或通过将3添加到{1,2}的子集来得到{1,2,3}的子集。

这表明n元素集{1,2,...,n}的子集数的递推关系是：
S(n) = 
- 1 如果 n=0
- 2S(n-1) 如果 n≥1

## 递推关系

这个递推关系的正确性证明

{1,2,...,n}的子集可以根据它们是否包含元素n来划分。

每个包含n的子集S可以通过将n添加到不包含n的子集S\{n}来以唯一方式构造。每个不包含n的子集S可以通过从包含n的唯一集合S∪{n}中移除n来构造。

所以，包含n的子集数正好等于不包含n的子集数。

因此，如果n>1，那么S(n)=2S(n-1)。

通过归纳法证明很容易。

## 迭代递推关系

设T(n)=rT(n-1)+a，其中r和a是常数。

找到表达以下内容的递推关系：
T(n) 关于 T(n-2)
T(n) 关于 T(n-3)
T(n) 关于 T(n-4)
...

我们能否推广这个来找到闭式解？

## 迭代递推关系

注意T(n)=rT(n-1)+a意味着∀i<n，T(n-i)=rT((n-i)-1))+a

然后，我们有：
T(n) = rT(n-1)+a
= r(rT(n-2)+a)+a = r²T(n-2)+ra+a
= r²(rT(n-3)+a)+ra+a = r³T(n-3)+r²a+ra+a
= r³(rT(n-4)+a)+r²a+ra+a = r⁴T(n-4)+r³a+r²a+ra+a

猜测T(n)=rⁿT(0)+a∑ᵢ₌₀ⁿ⁻¹ rⁱ

## 迭代递推关系

我们用来猜测解的方法称为迭代递推关系，因为我们重复（迭代地）使用递推关系。

另一种方法是从"自底向上"迭代，而不是"自顶向下"。

T(0)=b
T(1)=rT(0)+a=rb+a
T(2)=rT(1)+a=r(rb+a)+a=r²b+ra+a
T(3)=rT(2)+a=r³b+r²a+ra+a

这将导致相同的猜测T(n)=rⁿb+a∑ᵢ₌₀ⁿ⁻¹ rⁱ

## 递推关系的公式

**定理** 如果T(n)=rT(n-1)+a，T(0)=b，且r≠1，那么对于所有非负整数n，T(n)=rⁿb+a(1-rⁿ)/(1-r)

**归纳法证明**
基本情况：T(0)=r⁰b+a(1-r⁰)/(1-r)=b。所以当n=0时公式为真。
现在假设n>0且T(n-1)=rⁿ⁻¹b+a(1-rⁿ⁻¹)/(1-r)

## 递推关系的公式

**归纳法证明**
T(n) = rT(n-1)+a
= r(rⁿ⁻¹b+a(1-rⁿ⁻¹)/(1-r)) + a
= rⁿb + a(r-rⁿ)/(1-r) + a
= rⁿb + (ar-arⁿ + a - ar)/(1-r)
= rⁿb + a(1-rⁿ)/(1-r)

## 递推关系的公式

**定理** 如果T(n)=rT(n-1)+a，T(0)=b，且r≠1，那么对于所有非负整数n，T(n)=rⁿb+a(1-rⁿ)/(1-r)

**示例**: T(n)=3T(n-1)+2，其中T(0)=5

将r=3，a=2，b=5代入公式，得到T(n)=3ⁿ·5+2(1-3ⁿ)/(1-3)=3ⁿ·6-1

## 一阶线性递推关系

形式为T(n)=f(n)T(n-1)+g(n)的递推关系称为一阶线性递推关系。

- **一阶**因为它只依赖于后退一步，即T(n-1)
如果它依赖于T(n-2)，它将是二阶递推关系，例如T(n)=T(n-1)+2T(n-2)

- **线性**因为T(n-1)只出现一次幂
像T(n)=(T(n-1))²+3这样的东西将是非线性一阶递推关系

## 下节课内容
- 递推关系

## 相关知识点总结
- [[计数原理与组合数学]] - 计数原理与组合数学知识分块总结
- [[离散数学总览]] - 离散数学整体概述
