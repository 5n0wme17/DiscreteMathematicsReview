# Hulec13 - 递推关系深入与计数原理

## 一阶线性递推关系

形式为T(n)=f(n)T(n-1)+g(n)的递推关系称为一阶线性递推关系。

- **一阶**因为它只依赖于后退一步，即T(n-1)
如果它依赖于T(n-2)，它将是二阶递推关系，例如T(n)=T(n-1)+2T(n-2)

- **线性**因为T(n-1)只出现一次幂
像T(n)=(T(n-1))²+3这样的东西将是非线性一阶递推关系

## 一阶线性递推关系

T(n)=f(n)T(n-1)+g(n)

当f(n)是常数，比如r时，通解几乎和我们之前推导的一样容易。迭代递推关系得到：
T(n) = rT(n-1)+g(n)
= r(rT(n-2)+g(n-1))+g(n) = r²T(n-2)+rg(n-1)+g(n)
= r³T(n-3)+r²g(n-2)+rg(n-1)+g(n)
...
= rⁿT(0) + ∑ᵢ₌₀ⁿ⁻¹ rⁱg(n-i)

## 一阶线性递推关系

**定理** 对于任何正常数a和r，以及任何定义在非负整数上的函数g，一阶线性递推关系
T(n) = 
- rT(n-1)+g(n) 如果 n>0
- a 如果 n=0
的解是 T(n) = rⁿa + ∑ᵢ₌₁ⁿ rⁿ⁻ⁱg(i)

**归纳法证明**

## 示例

解 T(n)=4T(n-1)+2ⁿ，其中 T(0)=6

T(n) = 6·4ⁿ + ∑ᵢ₌₁ⁿ 4ⁿ⁻ⁱ·2ⁱ = 6·4ⁿ + 4ⁿ∑ᵢ₌₁ⁿ (1/2)ⁱ = 6·4ⁿ + (1-1/2ⁿ)·4ⁿ = 7·4ⁿ - 2ⁿ

## 示例

解 T(n)=3T(n-1)+n，其中 T(0)=10

T(n) = 10·3ⁿ + ∑ᵢ₌₁ⁿ 3ⁿ⁻ⁱ·i = 10·3ⁿ + 3ⁿ∑ᵢ₌₁ⁿ i·3⁻ⁱ

**定理**. 对于任何实数x≠1，∑ᵢ₌₁ⁿ ixⁱ = (nxⁿ⁺² - (n+1)xⁿ⁺¹ + x)/(1-x)²

## 示例

解 T(n)=3T(n-1)+n，其中 T(0)=10

T(n) = 10·3ⁿ + 3ⁿ∑ᵢ₌₁ⁿ i·3⁻ⁱ = 10·3ⁿ + 3ⁿ(-3/2(n+1)3⁻⁽ⁿ⁺¹⁾ - (n+1)3⁻⁽ⁿ⁺¹⁾ + 3/4) = 43/4·3ⁿ - (n+1)/2 - 1/4

## 递推关系解的增长速率

分治算法
迭代递推关系
三种不同的行为

## 分治算法

我们刚刚分析了形式为
T(n) = 
- b 如果 n=0
- r·T(n-1)+a 如果 n>0
的递推关系

这些对应于递归算法的分析，其中大小为n的问题通过递归解决大小为n-1的问题来解决。

T(n) = rⁿb + a(1-rⁿ)/(1-r)

我们现在将看形式为 T(n) = 
- 给定值 如果 n≤n₀
- r·T(n/m)+a 如果 n>n₀
的递推关系

## 二分搜索

有人选择了一个介于1和n之间的数字x。我们需要发现x。

我们只允许问两种类型的问题：
- x大于k吗？
- x等于k吗？

我们的策略将是总是问大于问题，在每一步将搜索范围减半，直到范围只包含一个数字，这时我们问最后一个等于问题。

## 二分搜索

**方法**: 每个猜测将问题减少到范围只有一半大小的问题。这将原始问题划分为只有一半大小的问题；我们现在可以（递归地）征服这个较小的问题。

**注意**: 当n是2的幂时，T(n)，在[1,n]上进行二分搜索的问题数，满足
T(n) = 
- 1 如果 n=1
- T(n/2)+1 如果 n≥2

这也可以通过归纳法证明，类似于汉诺塔递推关系。

## 二分搜索

T(n): 在[1,n]上进行二分搜索的问题数

**假设**: n是2的幂。给出T(n)的递推关系
T(n) = 
- 1 如果 n=1
- T(n/2)+1 如果 n≥2

二分搜索n个项目所需的问题数是：
第一步 + 对剩余n/2个项目执行二分搜索的时间

基本情况（1个项目）：T(1)=1 问："数字是k吗？"

## 二分搜索

(∗) T(n) = 
- C₁ 如果 n=1
- T(⌈n/2⌉)+ C₂ 如果 n≥2

为简单起见，我们将（通常）假设n是2的幂（或有时3或4），并且通常常数如C₁, C₂为1。这将让我们将如(*)的递推关系替换为如(**)的递推关系。

(∗∗) T(n) = 
- 1 如果 n=1
- T(n/2)+1 如果 n≥2

在实践中，(*)的解将非常接近(**)的解（这可以在数学上证明）。因此，我们可以将注意力限制在(**)上。

## 递推关系解的增长速率

分治算法
迭代递推关系
三种不同的行为

## 迭代递推关系：示例1

(∗) T(n) = 
- T(1) 如果 n=1
- 2T(n/2)+n 如果 n≥2

这对应于解决大小为n的问题，通过：
(i) 解决2个大小为n/2的子问题
(ii) 做n个单位的额外工作或使用T(1)工作作为n=1的"底部"情况

在"算法分析"课程中，这正是归并排序的工作方式。

我们现在看看如何通过代数迭代递推关系来解(*)。

## 迭代递推关系：示例1

代数迭代递推关系 T(n)=2T(n/2)+n

假设n是2的幂
= 2(2T(n/4)+n/2) + n
= 4(2T(n/8)+n/4) + 2n = 4T(n/4) + 2n
= 8T(n/8) + 3n
...
= 2ⁱT(n/2ⁱ) + in
...
= 2^log₂n T(n/2^log₂n) + (log₂n)n （当i=log₂n时结束）
= nT(1) + nlog₂n

## 迭代递推关系：示例1

我们刚刚迭代递推关系推导出(∗) T(n) = 
- T(1) 如果 n=1
- 2T(n/2)+n 如果 n≥2
的解是 nT(1) + nlog₂n

**注意**: 技术上，我们仍然需要使用归纳法来证明我们的解是正确的。实际上，我们从不明确执行这一步，因为归纳法如何工作是显而易见的。

## 迭代递推关系：示例2

(∗) T(n) = 
- 1 如果 n=1
- T(n/2)+1 如果 n≥2

T(n) = T(n/2) + 1
= (T(n/2²) + 1) + 1 = T(n/2²) + 2
= (T(n/2³) + 1) + 2 = T(n/2³) + 3
...
= T(n/2ⁱ) + i
...
= T(n/2^log₂n) + log₂n
= 1 + log₂n

## 迭代递推关系：示例3

(∗) T(n) = 
- 1 如果 n=1
- T(n/2)+n 如果 n≥2

T(n) = T(n/2) + n = T(n/2²) + n/2 + n = T(n/2³) + n/2² + n/2 + n
...
= T(n/2ⁱ) + n/2ⁱ⁻¹ + ··· + n/2² + n/2 + n
...
= T(n/2^log₂n) + n/2^log₂n⁻¹ + ··· + n/2² + n/2 + n
= 1 + 2 + 2² + ··· + n/2² + n/2 + n = Θ(n)

## 迭代递推关系：示例4

(∗) T(n) = 
- 1 如果 n<3
- 3T(n/3)+n 如果 n≥3

T(n) = 3T(n/3) + n
= 3(3T(n/3²) + n/3) + n = 3²T(n/3²) + 2n
= 3²(3T(n/3³) + n/3²) + 2n = 3³T(n/3³) + 3n
...
= 3ⁱT(n/3ⁱ) + in
...
= 3^log₃n T(n/3^log₃n) + nlog₃n
= nT(1) + nlog₃n = n + nlog₃n

## 主定理

**定理**（主定理）设a≥1，b>1为常数，f(n)为函数，T(n)为定义在非负整数上的递推关系：
T(n) = aT(n/b) + f(n)

其中我们将n/b解释为⌊n/b⌋或⌈n/b⌉。那么T(n)有如下渐近界：

1. 如果对于某个常数ε>0，f(n)=O(n^log_b a - ε)，那么T(n)=Θ(n^log_b a)
2. 如果f(n)=Θ(n^log_b a)，那么T(n)=Θ(n^log_b a log n)
3. 如果对于某个常数ε>0，f(n)=Ω(n^log_b a + ε)，且对于某个常数c<1和所有足够大的n，af(n/b)≤cf(n)，那么T(n)=Θ(f(n))

## 主定理（简化版本）

设a和b为大于1的常数，f(n)为函数，T(n)为递推关系：
T(n) = aT(n/b) + f(n)

那么T(n)有如下大Θ界：

1. 如果f(n)=O(n^log_b a - ε)对于某个ε>0，那么T(n)=Θ(n^log_b a)
2. 如果f(n)=Θ(n^log_b a)，那么T(n)=Θ(n^log_b a log n)
3. 如果f(n)=Ω(n^log_b a + ε)对于某个ε>0，且af(n/b)≤cf(n)对于某个c<1和所有足够大的n，那么T(n)=Θ(f(n))

## 主定理（特殊情况）

设a和b为大于1的常数，f(n)=nᵈ，T(n)为递推关系：
T(n) = aT(n/b) + nᵈ

那么T(n)的解有如下大Θ界：

1. 如果a<bᵈ，那么T(n)=Θ(nᵈ)
2. 如果a=bᵈ，那么T(n)=Θ(nᵈ log n)
3. 如果a>bᵈ，那么T(n)=Θ(n^log_b a)

## 计数

假设我们有一组具有某些属性的对象。计数用于确定这些对象的数量。

**示例**:
- 计算机程序中的步骤数
- 6-10个字符的密码数
- 8位电话号码数

计数可能非常困难，不简单。通过分解问题来简化解决方案。

## 基本计数规则

乘积规则
求和规则

- **计数分解为一系列依赖计数**（第一个计数中的每个元素与第二个计数的所有元素相关联）
- **计数分解为一组独立计数**（计数的元素是替代方案）

## 乘积规则

计数分解为一系列依赖计数（第一个计数中的每个元素与第二个计数的所有元素相关联）

**示例** 在礼堂中，座位用字母和1到50之间的数字标记（例如，A23）。总共有多少个座位？

我们可以列出所有或使用乘积规则。26×50=1300

## 乘积规则

**乘积规则**: 如果元素的计数可以分解为一系列依赖计数，其中第一个计数产生n₁个元素，第二个产生n₂个元素，第k个计数产生nₖ个元素，那么元素的总数是 n = n₁·n₂·...·nₖ

**示例**:
- 长度为7的不同位串有多少个？
- 从具有m个元素的集合到具有n个元素的集合有多少个不同的函数？
- 从具有m个元素的集合到具有n个元素的集合有多少个一对一函数？
- 有多少个满射函数？

## 求和规则

计数分解为一组独立计数（计数的元素是替代方案）

**示例** 你需要从城市A旅行到B。你可以乘飞机、火车或巴士。有12个不同的航班，5个不同的火车和10个巴士。你有多少种选择从A到B？

我们可以使用求和规则。12+5+10

## 求和规则

**求和规则**: 如果元素的计数可以分解为一组独立计数，其中第一个计数产生n₁个元素，第二个产生n₂个元素，第k个计数产生nₖ个元素，那么元素的总数是 n = n₁ + n₂ + ... + nₖ

## 更复杂的计数

通常需要求和规则和乘积规则的组合。

**示例** 每个密码长度为6到8个字符，其中每个字符是小写字母或数字。每个密码必须包含至少一个数字。有多少个可能的密码？

P = P₆ + P₇ + P₈

## 树图

树是由根、分支和叶子组成的结构。可以用于表示计数问题并记录我们为替代方案所做的选择。计数出现在叶子上。

**示例** 长度为4且没有两个连续1的位串有多少个？

## 树图

"5局3胜"的季后赛有多少种不同的方式进行？

## 鸽巢原理

假设有一组对象和一组存储它们的箱子。

鸽巢原理指出，如果对象多于箱子，那么至少有一个箱子包含多于一个对象。

## 鸽巢原理

**定理** 如果有k+1个对象和k个箱子，那么至少有一个箱子包含两个或更多对象。

**反证法证明**

**示例** 假设有367名学生。有没有两个人的生日相同？有5个箱子和12个对象。那么必须有一个箱子至少包含3个对象。为什么？

## 广义鸽巢原理

如果N个对象被放入k个箱子中，那么至少有一个箱子包含至少⌈N/k⌉个对象。

**示例** 假设有100名学生。他们中有多少人生于同一个月？

## 下节课内容
- 递推关系

## 相关知识点总结
- [[计数原理与组合数学]] - 计数原理与组合数学知识分块总结
- [[离散数学总览]] - 离散数学整体概述
