# Hulec14 - 容斥原理与组合数学

## 容斥原理

用于计数中分解产生两个具有重叠元素的独立计数任务的情况。

如果我们使用求和规则，一些元素会被重复计数。容斥原理：使用求和规则，然后修正重叠元素。

|A∪B| = |A| + |B| - |A∩B|

## 容斥原理

**示例** 有多少个长度为8的位串要么以'1'位开头，要么以'00'两位结尾？

- 容易计算以'1'开头的位串数：2⁷
- 容易计算以'00'结尾的位串数：2⁶
- 重复计数！！！
- 减去以'1'开头且以"00"结尾的字符串数：2⁵

## 容斥原理

**两个集合**
|E∪F| = |E| + |F| - |E∩F|

**三个集合**
|E∪F∪G| = |E| + |F| + |G| - |E∩F| - |E∩G| - |F∩G| + |E∩F∩G|

## 容斥原理

**一般形式**
|∪ᵢ₌₁ⁿ Eᵢ| = ∑ₖ₌₁ⁿ (-1)ᵏ⁺¹ ∑₁≤i₁<i₂<···<iₖ≤n |Eᵢ₁∩Eᵢ₂∩···∩Eᵢₖ|

**归纳法证明**
- 基本情况 (n=2): |E∪F| = |E| + |F| - |E∩F|
- 归纳假设: |∪ᵢ₌₁ⁿ⁻¹ Eᵢ| = ∑ₖ₌₁ⁿ⁻¹ (-1)ᵏ⁺¹ ∑₁≤i₁<i₂<···<iₖ≤n⁻¹ |Eᵢ₁∩Eᵢ₂∩···∩Eᵢₖ|

## 容斥原理

**归纳步骤**
设 E = E₁∪···∪Eₙ₋₁，且 F = Eₙ。
由 |E∪F| = |E| + |F| - |E∩F|
|∪ᵢ₌₁ⁿ Eᵢ| = |∪ᵢ₌₁ⁿ⁻¹ Eᵢ| + |Eₙ| - |(∪ᵢ₌₁ⁿ⁻¹ Eᵢ)∩Eₙ|

第一项由归纳假设给出。对于第三项，由分配律，
|(∪ᵢ₌₁ⁿ⁻¹ Eᵢ)∩Eₙ| = |∪ᵢ₌₁ⁿ⁻¹ (Eᵢ∩Eₙ)| = |∪ᵢ₌₁ⁿ⁻¹ Gᵢ|，其中 Gᵢ = Eᵢ∩Eₙ

## 容斥原理

这可以用来确定满射函数的数量。

A,B是两个集合，|A|=m，|B|=n。
(a) 从A到B有多少个满射函数？
(b) 从A到B有多少个函数至少不映射到B的一个元素？

#(a) + #(b) = nᵐ

## 容斥原理

设 Eᵢ - 不映射到B的元素i的函数集合
#(b) = |∪ᵢ₌₁ⁿ Eᵢ| = ∑ₖ₌₁ⁿ (-1)ᵏ⁺¹ ∑₁≤i₁<i₂<···<iₖ≤n |Eᵢ₁∩Eᵢ₂∩···∩Eᵢₖ|
= ∑ₖ₌₁ⁿ (-1)ᵏ⁺¹ (n选k) (n-k)ᵐ

## k元素排列

从{1,2,...,n}中选择一个有序的三元不同元素有多少种方式？

更一般地，从{1,2,...,n}中选择一个k个不同元素的列表有多少种方式？

从集合N中选择的k个不同元素的列表称为N的k元素排列。

注意k=n的情况是特殊的；大小为|N|=n的集合N的n元素排列就是我们之前简单称为排列的东西。

## k元素排列

{1,2,...,n}的三元素排列有多少个？

- 第一个数有n种选择
- 对于选择第一个数的每种方式，第二个数有n-1种选择
- 对于选择前两个数的每种方式，第三个数有n-2种选择

由乘积规则，有n(n-1)(n-2)种方式选择排列

## 示例

由乘积规则，有n(n-1)(n-2)种方式选择排列

**示例**: 当n=4时，有4×3×2=24个{1,2,3,4}的3元素排列
L = {123,124,132,134,142,143,213,214,231,234,241,243,312,314,321,324,341,342,412,413,421,423,431,432}

**注意**: 这种类型的元组"字典"排序（假设我们像处理字母一样处理数字）称为字典序，经常使用。

## k元素排列

**定理** 如果N是正整数，k是满足1≤k≤n的整数，那么有
P(n,k) = n(n-1)(n-2)···(n-k+1)
个具有n个不同元素的k元素排列。

这如何帮助我们解决原始问题（从三角形程序）计算3元素子集的数量？

注意每个3元素子集{i,j,k}可以恰好变成6个3元素排列
(#3元素排列) = 6 × (#3元素子集)
P(n,3) = 3! · C(n,3)

## 二项式系数

**定理** 对于满足0≤k≤n的整数n和k，n元素集合的k元素子集数是
(n选k) = C(n,k) = P(n,k)/k! = n!/[k!(n-k)!]

这是具有n个元素的集合的k组合数。

## 二项式系数的性质

(n选k) = n!/[k!(n-k)!]
(n选0) = 1 （只有大小为0的一个集合）
(n选n) = 1 （只有大小为n的一个集合）
(n选k) = (n选n-k) （从方程明显看出。你能想出一个简单的双射来解释这个吗？）

## 二项式系数的性质（续）

∑ᵢ₌₀ⁿ (n选i) = 2ⁿ

**使用求和规则**
设 P = {1,2,...,n}的所有子集的集合
Sᵢ = {1,2,...,n}的所有i子集的集合
⇒ |P| = ∑ᵢ₌₀ⁿ |Sᵢ| = ∑ᵢ₌₀ⁿ (n选i)

设 L = L₁L₂...Lₙ 是来自{0,1}的长度为n的列表
如果 L = 所有这样的列表的集合，则 |L| = 2ⁿ
在P和L之间存在双射

## 二项式系数的性质（续）

(n选k) = (n-1选k-1) + (n-1选k)

**组合证明**
考虑 S = {A,B,C,D,E}。
S₁ = {{A,B},{A,C},{A,D},{A,E},{B,C},{B,D},{B,E},{C,D},{C,E},{D,E}}。S的2子集集合
S₂包含E的2子集和S₃，不包含E的2子集集合。可以划分为2个不相交的部分。

## 组合证明

如果n和k是满足0<k<n的整数，那么 (n选k) = (n-1选k-1) + (n-1选k)

**证明**: 应用求和规则。
设 S₁ 为所有k元素子集的集合。
要应用求和规则，将 S₁ 划分为 S₂ 和 S₃。
设 S₂ 为包含xₙ的k元素子集的集合。
设 S₃ 为不包含xₙ的k元素子集的集合。

## 布莱兹·帕斯卡

生于1623年；卒于1662年
法国数学家
概率论的创始人之一
第一台机械计算器的发明者
帕斯卡编程语言以他命名

## 二项式定理

(x+y) = (1选0)x + (1选1)y
(x+y)² = x² + 2xy + y² = (2选0)x² + (2选1)x¹y¹ + (2选2)y²
(x+y)³ = x³ + 3x²y + 3xy² + y³ = (3选0)x³ + (3选1)x²y + (3选2)xy² + (3选3)y³

## 二项式定理

n元素集合的k元素子集数称为二项式系数，因为它在二项式(x+y)ⁿ的代数展开中的作用。

**二项式定理** 对于任何整数n≥0，
(x+y)ⁿ = (n选0)xⁿ + (n选1)xⁿ⁻¹y + (n选2)xⁿ⁻²y² + ... + (n选n-1)xyⁿ⁻¹ + (n选n)yⁿ

(x+y)ⁿ = ∑ᵢ₌₀ⁿ (n选i)xⁿ⁻ⁱyⁱ

**证明？**

## 二项式定理的应用

我们可以使用二项式定理证明 ∑ᵢ₌₀ⁿ (n选i) = 2ⁿ

## 标记和三项式系数

假设我们有k个一种标签，例如红色，和n-k个另一种标签，例如蓝色。我们有多少种不同的方式将这些标签应用到n个对象上？

证明如果我们有k₁个一种标签，例如红色，k₂个第二种标签，例如蓝色，和k₃ = n-k₁-k₂个第三种标签，那么有 n!/(k₁!k₂!k₃!) 种方式将这些标签应用到n个对象上

(x+y+z)ⁿ中xᵏ¹yᵏ²zᵏ³的系数是什么？

## 标记和三项式系数

有 (n选k₁) 种方式选择红色项目
然后有 (n-k₁选k₂) 种方式从剩余的n-k₁中选择蓝色项目。
剩余的k₃个项目被标记为第三种颜色。

使用乘积规则，标签的总数是
(n选k₁)(n-k₁选k₂) = n!/[k₁!(n-k₁)!] × (n-k₁)!/[k₂!(n-k₁-k₂)!] = n!/[k₁!k₂!(n-k₁-k₂)!] = n!/[k₁!k₂!k₃!]

## 标记和三项式系数

当 k₁+k₂+k₃ = n 时，我们称 n!/[k₁!k₂!k₃!] 为三项式系数，并表示为
(n选k₁ k₂ k₃)

(x+y+z)ⁿ中xᵏ¹yᵏ²zᵏ³的系数是什么？

## 生日悖论

假设房间里有25名学生。至少有两个人生日相同的概率是多少？

大于1/2！（只需要23人）

Aₙ - "房间里有n名学生，至少有两个人生日相同。"

我们可以假设一年有365天，房间里没有双胞胎。

## 生日悖论

样本空间：|S| = 365ⁿ
Aₙ - "房间里有n名学生，至少有两个人生日相同。"
Bₙ - "房间里有n名学生，没有人生日相同。"
#Bₙ = 365 × 364 × ··· × (365-(n-1))
#Aₙ + #Bₙ = 365ⁿ

## 生日悖论

事件A：房间里至少有两个人生日相同
事件B：房间里没有人生日相同
Pr[A] = 1 - Pr[B]
Pr[B] = (1-1/365) × (1-2/365) × ··· × (1-(n-1)/365) = ∏ᵢ₌₁ⁿ⁻¹ (1-i/365)
Pr[A] = 1 - ∏ᵢ₌₁ⁿ⁻¹ (1-i/365)

p(n;H) := 1 - ∏ᵢ₌₁ⁿ⁻¹ (1-i/H)

## "生日"攻击

由于 eˣ = 1 + x + x²/2! + ···，对于 |x| ≪ 1，eˣ ≈ 1 + x

因此，我们有 e⁻ⁱ/ᴴ ≈ 1 - i/H。

回忆 p(n;H) := 1 - ∏ᵢ₌₁ⁿ⁻¹ (1-i/H)
这个概率可以近似为 p(n;H) ≈ 1 - e⁻ⁿ⁽ⁿ⁻¹⁾/²ᴴ ≈ 1 - e⁻ⁿ²/²ᴴ

设 n(p;H) 是我们要选择的最小值数，使得找到冲突的概率至少为 p。通过反转上面的表达式，我们有 n(p;H) ≈ √[2H ln(1/(1-p))]

## 下节课内容
- 求解线性递推关系

## 相关知识点总结
- [[计数原理与组合数学]] - 计数原理与组合数学知识分块总结
- [[离散数学总览]] - 离散数学整体概述
